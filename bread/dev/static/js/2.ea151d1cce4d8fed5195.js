webpackJsonp([2,14,15],{"4d9Z":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".task-inform[data-v-06961d73]{padding:30px 20px 20px;background-color:#fff}.task-inform .seed-name[data-v-06961d73]{color:#323232;font-size:14px}.task-inform .typeIn[data-v-06961d73]{margin-left:4px}.task-inform header[data-v-06961d73]{display:-webkit-box;display:-ms-flexbox;display:flex}.task-header-typeIn[data-v-06961d73]{display:block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-negative:1;flex-shrink:1}.task-header-btn[data-v-06961d73],.task-header .test[data-v-06961d73]{display:block}.task-header-btn .ivu-btn[data-v-06961d73],.task-header .test .ivu-btn[data-v-06961d73]{padding:6px 23px;font-size:14px}.task-header-btn .ivu-btn[data-v-06961d73]:last-child,.task-header .test .ivu-btn[data-v-06961d73]:last-child{margin-left:10px}.task-section[data-v-06961d73]{margin-top:40px}.task-section .ivu-tabs-tabpane[data-v-06961d73]:first-child{padding-bottom:300px}.ivu-form-item[data-v-06961d73]{margin-bottom:0}",""])},GGoc:function(e,t,a){var r=a("Rk+3");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("a209f1ea",r,!0)},JZQd:function(e,t,a){var r=a("o5+z");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("48e3109d",r,!0)},"Rk+3":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".task-manager-basic{margin-top:-16px;padding:20px}.periodic{display:inline-block;padding:10px 12px 10px 0;width:130px;color:#323232;text-align:right;font-size:14px}.periodicWeight{margin-left:10px;width:150px}",""])},WqZm:function(e,t,a){"use strict";function r(e){a("qHjb")}Object.defineProperty(t,"__esModule",{value:!0});var l=a("wSCC"),s=a("ceQ9"),i=a("u8GW"),n=a("OjDh"),o={name:"TaskManagerChild",data:function(){return{signStatus:!1,signUserStatus:!1,formValidate:{taskName:""},ruleValidate:{taskName:[{required:!0,message:"任务名不能为空",trigger:"blur"}]}}},methods:{handleBack:function(){this.$router.push("/basic/taskManager")},signOff:function(){var e=this;Object(i.q)({taskId:this.$route.query.taskId,token:Object(n.a)("token")}).then(function(t){"0"===t.data.respCode&&(e.$Message.success("签出成功"),e.signStatus=!0)})},signIn:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(""===t.$refs.property.startTimeVal||""===t.$refs.property.endTimeVal)return t.$Message.warning("采集时间不能为空"),!1;if(""===t.$refs.model.startAddressVal)return t.$Message.warning("采集起始地址不能为空"),!1;Object(i.p)({taskId:t.$route.query.taskId,taskName:t.formValidate.taskName,taskPeriodType:t.$refs.property.taskCycleTypeVal,charSet:t.$refs.property.codingSchemeVal,requestType:t.$refs.property.requestMethodVal,deduplicate:t.$refs.property.urlDeWeightVal?1:0,periodicDeduplicate:t.$refs.property.periodicWeightVal?1:0,siteId:t.$refs.model.siteVal,maxDeduplicateTime:24*t.$refs.property.durationVal*60*60*1e3,connectionTimeout:1e3*t.$refs.property.connectionVal,maxRetryCount:t.$refs.property.numberVal,proxyId:t.$refs.property.agencyVal,priority:t.$refs.property.taskPriorityVal,userAgent:t.$refs.property.userAgentVal,startTime:new Date(t.$refs.property.startTimeVal).getTime(),endTime:new Date(t.$refs.property.endTimeVal).getTime(),crawlTimeInterval:t.$refs.property.intervalVal,startUrl:t.$refs.model.startAddressVal,moreStartUrl:t.$refs.model.moreStartAddressVal,status:t.$route.query.status,token:Object(n.a)("token")}).then(function(e){"0"===e.data.respCode?(t.signStatus=!1,t.$Message.success("签入成功")):t.$Message.error(e.data.respMsg)})}})},handleSave:function(e){var t=this;this.$refs[e].validate(function(e){return!!e&&(""===t.$refs.property.collectStartVal||""===t.$refs.property.collectEndVal?(t.$Message.warning("采集时间不能为空"),!1):""===t.$refs.model.startAddressVal?(t.$Message.warning("采集起始地址不能为空"),!1):void Object(i.o)({taskName:t.formValidate.taskName,taskPeriodType:t.$refs.property.taskCycleTypeVal,charSet:t.$refs.property.codingSchemeVal,requestType:t.$refs.property.requestMethodVal,deduplicate:t.$refs.property.urlDeWeightVal?1:0,periodicDeduplicate:t.$refs.property.periodicWeightVal?1:0,siteId:t.$refs.model.siteVal,maxDeduplicateTime:24*t.$refs.property.durationVal*60*60*1e3,connectionTimeout:1e3*t.$refs.property.connectionVal,maxRetryCount:t.$refs.property.numberVal,proxyId:t.$refs.property.agencyVal,priority:t.$refs.property.taskPriorityVal,userAgent:t.$refs.property.userAgentVal,startTime:new Date(t.$refs.property.startTimeVal).getTime(),endTime:new Date(t.$refs.property.endTimeVal).getTime(),crawlTimeInterval:t.$refs.property.intervalVal,startUrl:t.$refs.model.startAddressVal,moreStartUrl:t.$refs.model.moreStartAddressVal,token:Object(n.a)("token")}).then(function(e){switch(e.data.respCode){case"0":t.$Message.success("任务添加成功"),t.$router.push("/basic/taskManager");break;case"201":case"204":t.$Message.warning(e.data.respMsg)}}))})},formatDate:function(e){var t=new Date(e),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):""+(t.getMonth()+1);return t.getFullYear()+"-"+a+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},initTaskQuery:function(){var e=this;Object(i.s)({taskId:this.$route.query.taskId,token:Object(n.a)("token")}).then(function(t){var a=t.data.data;e.formValidate.taskName=a.taskName,e.$refs.property.taskCycleTypeVal=a.taskPeriodType,e.$refs.property.codingSchemeVal=a.charSet,e.$refs.property.requestMethodVal=a.requestType,e.$refs.property.urlDeWeightVal=1===a.deduplicate,e.$refs.property.periodicDeduplicate=1===a.periodicDeduplicate,e.$refs.property.durationVal=a.maxDeduplicateTime/864e5,e.$refs.property.connectionVal=a.connectionTimeout/1e3,e.$refs.property.numberVal=a.maxRetryCount,e.$refs.property.agencyVal=a.proxyId,e.$refs.property.taskPriorityVal=a.priority,e.$refs.property.intervalVal=a.crawlTimeInterval,e.$refs.property.userAgentVal=a.userAgent,e.$refs.model.siteVal=a.siteId,e.$refs.model.startAddressVal=a.startUrl,e.$refs.model.moreStartAddressVal=a.moreStartUrl,e.$refs.property.startTimeVal=e.formatDate(a.startTime),e.$refs.property.endTimeVal=e.formatDate(a.endTime)})}},computed:{getUpdatePersonId:function(){return JSON.parse(Object(n.a)("userInfo")).userId}},components:{taskBasicAttribute:l.default,taskPageModel:s.default},created:function(){"alter"===this.$route.params.id&&this.initTaskQuery(),"alter"===this.$route.params.id&&"1"===this.$route.query.checkType&&(this.signStatus=!0),"alter"===this.$route.params.id&&"1"===this.$route.query.checkType&&parseInt(this.$route.query.updatePersonId)!==this.getUpdatePersonId&&(this.signUserStatus=!0)}},c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"task-inform"},[a("header",[a("div",{staticClass:"task-header-typeIn"},[a("Form",{ref:"formTaskName",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"任务名称",prop:"taskName"}},[a("Input",{staticStyle:{"max-width":"300px"},attrs:{placeholder:""},model:{value:e.formValidate.taskName,callback:function(t){e.$set(e.formValidate,"taskName",t)},expression:"formValidate.taskName"}})],1)],1)],1),a("div",{staticClass:"task-header-btn"},["alter"===e.$route.params.id?a("Button",{attrs:{type:"success",disabled:e.signStatus},on:{click:e.signOff}},[e._v("签出")]):e._e(),"alter"===e.$route.params.id?a("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",disabled:!e.signStatus||e.signUserStatus},on:{click:function(t){e.signIn("formTaskName")}}},[e._v("签入")]):e._e(),"add"===e.$route.params.id?a("Button",{attrs:{type:"success"},on:{click:function(t){e.handleSave("formTaskName")}}},[e._v("保存")]):e._e(),a("Button",{attrs:{type:"primary"},on:{click:e.handleBack}},[e._v("返回")])],1)]),a("section",{staticClass:"task-section"},[a("Tabs",{attrs:{type:"card"}},[a("TabPane",{attrs:{label:"基本属性"}},[a("taskBasicAttribute",{ref:"property"})],1),a("TabPane",{attrs:{label:"页面模型"}},[a("taskPageModel",{ref:"model"})],1)],1)],1)])},d=[],u={render:c,staticRenderFns:d},p=u,m=a("VU/8"),f=r,y=m(o,p,!1,f,"data-v-06961d73",null);t.default=y.exports},ceQ9:function(e,t,a){"use strict";function r(e){a("JZQd")}Object.defineProperty(t,"__esModule",{value:!0});var l=a("u8GW"),s=a("OjDh"),i={name:"TaskPageModel",data:function(){return{siteData:[],siteVal:"",startAddressVal:"",moreStartAddressVal:"",addressData:[]}},methods:{handleMate:function(){var e=this;if(""===this.startAddressVal)return this.$Message.warning("采集起始地址不能为空"),!1;Object(l.d)({siteId:this.siteVal,modelurl:this.startAddressVal,token:Object(s.a)("token")}).then(function(t){0===t.data.data.length&&e.$Message.info("匹配页面模型为空"),e.addressData=t.data.data})}},created:function(){var e=this;Object(l.c)({token:Object(s.a)("token")}).then(function(t){e.siteData=t.data.data,e.siteVal=e.siteData[0].siteId})}},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"task-manager-page"},[a("Form",{attrs:{"label-width":100}},[a("Row",[a("Col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:"站点:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.siteVal,callback:function(t){e.siteVal=t},expression:"siteVal"}},e._l(e.siteData,function(t){return a("Option",{key:t.siteId,attrs:{value:t.siteId}},[e._v(e._s(t.siteName))])}))],1),a("FormItem",{attrs:{label:"采集起始地址:"}},[a("Input",{staticStyle:{width:"300px"},model:{value:e.startAddressVal,callback:function(t){e.startAddressVal=t},expression:"startAddressVal"}}),a("Button",{staticClass:"mate",attrs:{type:"primary"},on:{click:e.handleMate}},[e._v("匹配")])],1),a("FormItem",{attrs:{label:"更多起始地址"}},[a("Input",{staticStyle:{width:"600px"},attrs:{type:"textarea",rows:6},model:{value:e.moreStartAddressVal,callback:function(t){e.moreStartAddressVal=t},expression:"moreStartAddressVal"}})],1)],1),a("Col",{attrs:{span:"8"}},[0!==e.addressData.length?a("aside",[a("span",[e._v("匹配模型:")]),a("ul",e._l(e.addressData,function(t){return a("li",[e._v(e._s(t.modelName))])}))]):e._e()])],1)],1)],1)},o=[],c={render:n,staticRenderFns:o},d=c,u=a("VU/8"),p=r,m=u(i,d,!1,p,null,null);t.default=m.exports},"o5+z":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,".task-manager-page{margin-top:-16px;padding:20px}.task-manager-page .mate{margin-left:15px}.ivu-form .ivu-form-item-label{color:#323232;font-size:14px}",""])},qHjb:function(e,t,a){var r=a("4d9Z");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("cb841a40",r,!0)},wSCC:function(e,t,a){"use strict";function r(e){a("GGoc")}Object.defineProperty(t,"__esModule",{value:!0});var l=a("//Fk"),s=a.n(l),i=a("u8GW"),n=a("OjDh"),o={name:"TaskBasicAttribute",data:function(){return{startTimeVal:"",endTimeVal:"",taskCycleTypeVal:"",codingSchemeVal:"utf-8",requestMethodVal:"",urlDeWeightVal:!1,durationVal:1,connectionVal:10,numberVal:1,agencyVal:0,taskPriorityVal:"",intervalVal:5,userAgentVal:"",periodicWeight:!0,periodicWeightVal:!1,taskCycleTypeData:[],codingSchemeData:[{value:"utf-8",label:"utf-8"},{value:"gbk",label:"gbk"},{value:"gb2312",label:"gb2312"}],requestMethodValData:[],theRetentionTimeData:[{value:1,label:"1天"},{value:2,label:"2天"},{value:5,label:"5天"},{value:7,label:"7天"},{value:10,label:"10天"},{value:15,label:"15天"},{value:30,label:"1月"},{value:60,label:"2月"},{value:90,label:"3月"},{value:365,label:"1年"}],connectionTimeoutData:[{value:10,label:"10秒"},{value:20,label:"20秒"},{value:30,label:"30秒"},{value:60,label:"1分钟"},{value:120,label:"2分钟"},{value:180,label:"3分钟"},{value:300,label:"5分钟"}],numberOfRetriesData:[{value:1,label:"1次"},{value:3,label:"3次"},{value:5,label:"5次"}],agencyData:[{value:0,label:"不需要"},{value:1,label:"境内动态"}],taskPriorityValData:[],intervalData:[{value:5,label:"5秒"},{value:10,label:"10秒"},{value:20,label:"20秒"},{value:30,label:"30秒"},{value:60,label:"1分钟"},{value:120,label:"2分钟"},{value:180,label:"3分钟"},{value:300,label:"5分钟"},{value:600,label:"10分钟"},{value:900,label:"15分钟"},{value:1200,label:"20分钟"},{value:1800,label:"30分钟"},{value:3600,label:"1小时"},{value:7200,label:"2小时"},{value:10800,label:"3小时"},{value:43200,label:"12小时"},{value:86400,label:"1天"},{value:172800,label:"2天"},{value:604800,label:"1周"},{value:2592e3,label:"1月"}]}},methods:{setAttr:function(){document.querySelectorAll(".ivu-input")[1].setAttribute("readonly",!0),document.querySelectorAll(".ivu-input")[2].setAttribute("readonly",!0)},initQueryType:function(e){return new s.a(function(t,a){Object(i.l)({typeId:e,token:Object(n.a)("token")}).then(function(e){t(e)}).catch(function(e){a(e.statusCode)})})},collectStart:function(e){""!==e&&(this.startTimeVal=e)},collectEnd:function(e){""!==e&&(this.endTimeVal=e)}},watch:{taskCycleTypeVal:function(e){e&&(this.periodicWeight=!this.periodicWeight)}},created:function(){var e=this,t=this.initQueryType(5),a=this.initQueryType(7),r=this.initQueryType(6);s.a.all([t,a,r]).then(function(t){e.taskCycleTypeData=t[0].data.data,e.requestMethodValData=t[1].data.data,e.taskPriorityValData=t[2].data.data,"add"===e.$route.params.id&&(e.taskCycleTypeVal=e.taskCycleTypeData[0].itemType,e.requestMethodVal=e.requestMethodValData[0].itemType,e.taskPriorityVal=e.taskPriorityValData[0].itemType)})}},c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"task-manager-basic"},[a("Form",{attrs:{"label-width":130}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"任务周期类型:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.taskCycleTypeVal,callback:function(t){e.taskCycleTypeVal=t},expression:"taskCycleTypeVal"}},e._l(e.taskCycleTypeData,function(t){return a("Option",{key:t.itemType,attrs:{value:t.itemType}},[e._v(e._s(t.itemName))])}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"编码:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.codingSchemeVal,callback:function(t){e.codingSchemeVal=t},expression:"codingSchemeVal"}},e._l(e.codingSchemeData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"页面请求方式:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.requestMethodVal,callback:function(t){e.requestMethodVal=t},expression:"requestMethodVal"}},e._l(e.requestMethodValData,function(t){return a("Option",{key:t.itemType,attrs:{value:t.itemType}},[e._v(e._s(t.itemName))])}))],1)],1),a("Col",{attrs:{span:"8"}},[a("aside",{staticStyle:{display:"inline-block"}},[a("label",{staticClass:"periodic"},[e._v("需要URL去重:")]),a("checkbox",{model:{value:e.urlDeWeightVal,callback:function(t){e.urlDeWeightVal=t},expression:"urlDeWeightVal"}})],1),e.periodicWeight?a("aside",{staticStyle:{display:"inline-block"}},[a("label",{staticClass:"periodic periodicWeight"},[e._v("需要URL周期性去重")]),a("checkbox",{model:{value:e.periodicWeightVal,callback:function(t){e.periodicWeightVal=t},expression:"periodicWeightVal"}})],1):e._e()])],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"URL去重保留时长:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.durationVal,callback:function(t){e.durationVal=t},expression:"durationVal"}},e._l(e.theRetentionTimeData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"连接超时时间:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.connectionVal,callback:function(t){e.connectionVal=t},expression:"connectionVal"}},e._l(e.connectionTimeoutData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"最大重试次数:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.numberVal,callback:function(t){e.numberVal=t},expression:"numberVal"}},e._l(e.numberOfRetriesData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"代理选择:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.agencyVal,callback:function(t){e.agencyVal=t},expression:"agencyVal"}},e._l(e.agencyData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"优先级:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.taskPriorityVal,callback:function(t){e.taskPriorityVal=t},expression:"taskPriorityVal"}},e._l(e.taskPriorityValData,function(t){return a("Option",{key:t.itemType,attrs:{value:t.itemType}},[e._v(e._s(t.itemName))])}))],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"采集时间间隔:"}},[a("Select",{staticStyle:{width:"300px"},model:{value:e.intervalVal,callback:function(t){e.intervalVal=t},expression:"intervalVal"}},e._l(e.intervalData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"采集开始时间:"}},[a("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"datetime",value:e.startTimeVal,placeholder:"选择日期"},on:{"on-change":e.collectStart,"on-open-change":e.setAttr}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"采集结束时间:"}},[a("DatePicker",{staticStyle:{width:"300px"},attrs:{type:"datetime",value:e.endTimeVal,placeholder:"选择日期"},on:{"on-change":e.collectEnd,"on-open-change":e.setAttr}})],1)],1)],1),a("FormItem",{attrs:{label:"用户代理:"}},[a("Input",{staticStyle:{width:"58%"},model:{value:e.userAgentVal,callback:function(t){e.userAgentVal=t},expression:"userAgentVal"}})],1)],1)],1)},d=[],u={render:c,staticRenderFns:d},p=u,m=a("VU/8"),f=r,y=m(o,p,!1,f,null,null);t.default=y.exports}});